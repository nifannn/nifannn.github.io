<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="keyword"  content="">
    <link rel="shortcut icon" href="/img/ironman-draw.png">
    <!-- Place this tag in your head or just before your close body tag. -->
    <script async defer src="https://buttons.github.io/buttons.js"></script>
    <title>
        
          SQL Notes: Hackerrank The PADS - Memogrocery
        
    </title>

    <link rel="canonical" href="https://nifannn.github.io/2017/10/21/SQL-Notes-Hackerrank-The-PADS/">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <!-- Custom CSS --> 
    <link rel="stylesheet" href="/css/beantech.min.css">
    
    <!-- Pygments Highlight CSS -->
    <link rel="stylesheet" href="/css/highlight.css">

    <link rel="stylesheet" href="/css/widget.css">

    <link rel="stylesheet" href="/css/rocket.css">

    <link rel="stylesheet" href="/css/signature.css">

    <link rel="stylesheet" href="/css/toc.css">

    <!-- Custom Fonts -->
    <!-- <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css"> -->
    <!-- Hux change font-awesome CDN to qiniu -->
    <link href="https://cdn.staticfile.org/font-awesome/4.5.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">


    <!-- Hux Delete, sad but pending in China
    <link href='http://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/
    css'>
    -->


    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- ga & ba script hoook -->
    <script></script>
</head>


<!-- hack iOS CSS :active style -->
<body ontouchstart="">
	<!-- Modified by Yu-Hsuan Yen -->
<!-- Post Header -->
<style type="text/css">
    header.intro-header{
        
            background-image: url('sql.jpg')
            /*post*/
        
    }
    
</style>

<header class="intro-header" >
    <!-- Signature -->
    <div id="signature">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                
                    <div class="post-heading">
                        <div class="tags">
                            
                              <a class="tag" href="/tags/#SQL" title="SQL">SQL</a>
                            
                              <a class="tag" href="/tags/#Hackerrank" title="Hackerrank">Hackerrank</a>
                            
                        </div>
                        <h1>SQL Notes: Hackerrank The PADS</h1>
                        <h2 class="subheading"></h2>
                        <span class="meta">
                            Posted by Fan Ni on
                            2017-10-21
                        </span>
                    </div>
                


                </div>
            </div>
        </div>
    </div>
</header>

	
    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Memogrocery</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <!-- Known Issue, found by Hux:
            <nav>'s height woule be hold on by its content.
            so, when navbar scale out, the <nav> will cover tags.
            also mask any touch event of tags, unfortunately.
        -->
        <div id="huxblog_navbar">
            <div class="navbar-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="/">Home</a>
                    </li>

                    

                        
                    

                        
                        <li>
                            <a href="/archive/">Archives</a>
                        </li>
                        
                    

                        
                        <li>
                            <a href="/about/">About</a>
                        </li>
                        
                    

                        
                        <li>
                            <a href="/tags/">Tags</a>
                        </li>
                        
                    
                    
                </ul>
            </div>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>
<script>
    // Drop Bootstarp low-performance Navbar
    // Use customize navbar with high-quality material design animation
    // in high-perf jank-free CSS3 implementation
    var $body   = document.body;
    var $toggle = document.querySelector('.navbar-toggle');
    var $navbar = document.querySelector('#huxblog_navbar');
    var $collapse = document.querySelector('.navbar-collapse');

    $toggle.addEventListener('click', handleMagic)
    function handleMagic(e){
        if ($navbar.className.indexOf('in') > 0) {
        // CLOSE
            $navbar.className = " ";
            // wait until animation end.
            setTimeout(function(){
                // prevent frequently toggle
                if($navbar.className.indexOf('in') < 0) {
                    $collapse.style.height = "0px"
                }
            },400)
        }else{
        // OPEN
            $collapse.style.height = "auto"
            $navbar.className += " in";
        }
    }
</script>


    <!-- Main Content -->
    <!-- Modify by Yu-Hsuan Yen -->

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">

            <!-- Post Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                post-container">

                <h3 id="problem">Problem</h3>
<hr>
<p>Generate the following two result sets:</p>
<ol>
<li>Query an <em>alphabetically ordered</em> list of all names in <strong>OCCUPATIONS</strong>, immediately followed by the first letter of each profession as a parenthetical (i.e.: enclosed in parentheses). For example: AnActorName(A), ADoctorName(D), AProfessorName(P), and ASingerName(S).</li>
<li>Query the number of ocurrences of each occupation in <strong>OCCUPATIONS</strong>. Sort the occurrences in <em>ascending order</em>, and output them in the following format:</li>
</ol>
<blockquote>
<p>There are a total of [occupation_count] [occupation]s.</p>
</blockquote>
<p>where [occupation_count] is the number of occurrences of an occupation in <strong>OCCUPATIONS</strong> and [occupation] is the <em>lowercase</em> occupation name. If more than one <em>Occupation</em> has the same [occupation_count], they should be ordered alphabetically.<br>
<strong>Note</strong>: There will be at least two entries in the table for each type of occupation.</p>
<p><strong>Input Format</strong><br>
The <strong>OCCUPATIONS</strong> table is described as follows:</p>
<table>
<thead>
<tr>
<th>Column</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>Name</td>
<td>String</td>
</tr>
<tr>
<td>Occupation</td>
<td>String</td>
</tr>
</tbody>
</table>
<p>Occupation will only contain one of the following values: <strong>Doctor</strong>, <strong>Professor</strong>, <strong>Singer</strong> or <strong>Actor</strong>.</p>
<p><strong>Sample Input</strong><br>
An <strong>OCCUPATIONS</strong> table that contains the following records:</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Occupation</th>
</tr>
</thead>
<tbody>
<tr>
<td>Samantha</td>
<td>Doctor</td>
</tr>
<tr>
<td>Julia</td>
<td>Actor</td>
</tr>
<tr>
<td>Maria</td>
<td>Actor</td>
</tr>
<tr>
<td>Meera</td>
<td>Singer</td>
</tr>
<tr>
<td>Ashely</td>
<td>Professor</td>
</tr>
<tr>
<td>Ketty</td>
<td>Professor</td>
</tr>
<tr>
<td>Christeen</td>
<td>Professor</td>
</tr>
<tr>
<td>Jane</td>
<td>Actor</td>
</tr>
<tr>
<td>Jenny</td>
<td>Doctor</td>
</tr>
<tr>
<td>Priya</td>
<td>Singer</td>
</tr>
</tbody>
</table>
<p><strong>Sample Output</strong></p>
<blockquote>
<p>Ashely(P)<br>
Christeen(P)<br>
Jane(A)<br>
Jenny(D)<br>
Julia(A)<br>
Ketty(P)<br>
Maria(A)<br>
Meera(S)<br>
Priya(S)<br>
Samantha(D)<br>
There are a total of 2 doctors.<br>
There are a total of 2 singers.<br>
There are a total of 3 actors.<br>
There are a total of 3 professors.</p>
</blockquote>
<p><strong>Explanation</strong><br>
The results of the first query are formatted to the problem description’s specifications.<br>
The results of the second query are ascendingly ordered first by number of names corresponding to each profession (2 ≤ 2 ≤ 3 ≤ 3), and then alphabetically by profession (<em>doctor</em> ≤ <em>singer</em>, and <em>actor</em> ≤ <em>professor</em>).</p>
<h3 id="analysis">Analysis</h3>
<hr>
<p>We can use CONCAT() function to solve this problem. The syntax is ‘CONCAT(str1, str2, …)’ and it returns the string that results from concatenating the arguments.<br>
And we can use SUBSTR() or LEFT() function to get first letter of Occupation. Syntax of SUBSTR() I use here is ‘SUBSTR(str, pos, len)’ and it returns a substring len characters long from string str, starting at position pos. Syntax of LEFT() is ‘LEFT(str, len)’ and it returns the leftmost len characters from the string str, or NULL if any argument is NULL.<br>
Additionally,</p>
<ul>
<li>from <strong>OCCUPATIONS</strong> table ==&gt; FROM OCCUPATIONS</li>
<li><em>alphabetically ordered</em> list of names ==&gt; ORDER BY Name</li>
<li>occupation_count ==&gt; COUNT(Occupation) … GROUP BY Occupation</li>
<li><em>lowercase</em> occupation name ==&gt; LOWER(Occupation)</li>
<li>sort occurrences in <em>ascending order</em> ==&gt; ORDER BY COUNT(Occupation)</li>
<li>order alphabetically if having the same occupation_count ==&gt;<br>
ORDER BY COUNT(Occupation), Occupation</li>
</ul>
<h3 id="solution">Solution</h3>
<hr>
<h4 id="solution-1">Solution 1</h4>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> <span class="keyword">CONCAT</span>(<span class="keyword">Name</span>, <span class="string">'('</span>, <span class="keyword">SUBSTR</span>(Occupation,<span class="number">1</span>,<span class="number">1</span>),<span class="string">')'</span>) <span class="keyword">FROM</span> OCCUPATIONS <span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="keyword">Name</span>;</div><div class="line"><span class="keyword">SELECT</span> <span class="keyword">CONCAT</span>(<span class="string">'There are a total of '</span>, <span class="keyword">COUNT</span>(Occupation), <span class="string">' '</span>, <span class="keyword">LOWER</span>(Occupation), <span class="string">'s.'</span>) <span class="keyword">FROM</span> OCCUPATIONS <span class="keyword">GROUP</span> <span class="keyword">BY</span> Occupation <span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="keyword">COUNT</span>(Occupation), Occupation;</div></pre></td></tr></table></figure>
<h4 id="solution-2">Solution 2</h4>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> <span class="keyword">CONCAT</span>(<span class="keyword">Name</span>, <span class="string">'('</span>, <span class="keyword">LEFT</span>(Occupation,<span class="number">1</span>),<span class="string">')'</span>) <span class="keyword">FROM</span> OCCUPATIONS <span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="keyword">Name</span>;</div><div class="line"><span class="keyword">SELECT</span> <span class="keyword">CONCAT</span>(<span class="string">'There are a total of '</span>, <span class="keyword">COUNT</span>(Occupation), <span class="string">' '</span>, <span class="keyword">LOWER</span>(Occupation), <span class="string">'s.'</span>) <span class="keyword">FROM</span> OCCUPATIONS <span class="keyword">GROUP</span> <span class="keyword">BY</span> Occupation <span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="keyword">COUNT</span>(Occupation), Occupation;</div></pre></td></tr></table></figure>
<h3 id="link">Link</h3>
<hr>
<p><a href="https://www.hackerrank.com/challenges/the-pads/problem" target="_blank" rel="external">The PADS</a><br>
<a href="/2018/05/31/SQL-%E7%AC%94%E8%AE%B0-Hackerrank-The-PADS/">(中文版) SQL 笔记: Hackerrank The PADS</a></p>

                

                <hr>
                <!-- Pager -->
                <ul class="pager">
                    
                        <li class="previous">
                            <a href="/2017/10/21/SQL-Notes-Hackerrank-Occupations/" data-toggle="tooltip" data-placement="top" title="SQL Notes: Hackerrank Occupations">&larr; Previous Post</a>
                        </li>
                    
                    
                        <li class="next">
                            <a href="/2017/10/21/SQL-Notes-Hackerrank-Type-of-Triangle/" data-toggle="tooltip" data-placement="top" title="SQL Notes: Hackerrank Type of Triangle">Next Post &rarr;</a>
                        </li>
                    
                </ul>

                <!-- duoshuo Share start -->
                
                <!-- 多说 Share end-->

                <!-- 多说评论框 start -->
                
                <!-- 多说评论框 end -->

                <!-- disqus comment start -->
                
                <!-- disqus comment end -->
            </div>
            
            <!-- Tabe of Content -->
            <!-- Table of Contents -->

    
      <aside id="sidebar">
        <div id="toc" class="toc-article">
        <strong class="toc-title">Contents</strong>
        
          <ol class="toc-nav"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#problem"><span class="toc-nav-number">1.</span> <span class="toc-nav-text">Problem</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#analysis"><span class="toc-nav-number">2.</span> <span class="toc-nav-text">Analysis</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#solution"><span class="toc-nav-number">3.</span> <span class="toc-nav-text">Solution</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#solution-1"><span class="toc-nav-number">3.1.</span> <span class="toc-nav-text">Solution 1</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#solution-2"><span class="toc-nav-number">3.2.</span> <span class="toc-nav-text">Solution 2</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#link"><span class="toc-nav-number">4.</span> <span class="toc-nav-text">Link</span></a></li></ol>
        
        </div>
      </aside>
    

                
            <!-- Sidebar Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                sidebar-container">

                <!-- Featured Tags -->
                
                <section>
                    <!-- no hr -->
                    <h5><a href="/tags/">FEATURED TAGS</a></h5>
                    <div class="tags">
                       
                          <a class="tag" href="/tags/#SQL" title="SQL">SQL</a>
                        
                          <a class="tag" href="/tags/#Hackerrank" title="Hackerrank">Hackerrank</a>
                        
                    </div>
                </section>
                

                <!-- Friends Blog -->
                
            </div>
        </div>
    </div>
</article>







<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>
<!-- anchor-js, Doc:http://bryanbraun.github.io/anchorjs/ -->
<script>
    async("https://cdn.bootcss.com/anchor-js/1.1.1/anchor.min.js",function(){
        anchors.options = {
          visible: 'hover',
          placement: 'left',
          icon: 'ℬ'
        };
        anchors.add().remove('.intro-header h1').remove('.subheading').remove('.sidebar-container h5');
    })
</script>
<style>
    /* place left on bigger screen */
    @media all and (min-width: 800px) {
        .anchorjs-link{
            position: absolute;
            left: -0.75em;
            font-size: 1.1em;
            margin-top : -0.1em;
        }
    }
</style>



    <!-- Footer -->
    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                
                
                

                

                

                
                    <li>
                        <a target="_blank"  href="https://github.com/nifannn">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                

                
                    <li>
                        <a target="_blank"  href="https://www.linkedin.com/in/fan-ni">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-linkedin fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                

                </ul>
                <p class="copyright text-muted">
                    Copyright &copy; Fan Ni 2019 
                    <br>
                    Theme by <a href="http://huangxuan.me">Hux</a> 
                    <span style="display: inline-block; margin: 0 5px;">
                        <i class="fa fa-heart"></i>
                    </span> 
                    re-Ported by <a href="http://beantech.org">BeanTech</a> | 
                    <iframe
                        style="margin-left: 2px; margin-bottom:-5px;"
                        frameborder="0" scrolling="0" width="91px" height="20px"
                        src="https://ghbtns.com/github-btn.html?user=YenYuHsuan&repo=hexo-theme-beantech&type=star&count=true" >
                    </iframe>
                </p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js"></script>

<!-- Bootstrap Core JavaScript -->
<script src="/js/bootstrap.min.js"></script>

<!-- Custom Theme JavaScript -->
<script src="/js/hux-blog.min.js"></script>


<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>

<!-- 
     Because of the native support for backtick-style fenced code blocks 
     right within the Markdown is landed in Github Pages, 
     From V1.6, There is no need for Highlight.js, 
     so Huxblog drops it officially.

     - https://github.com/blog/2100-github-pages-now-faster-and-simpler-with-jekyll-3-0  
     - https://help.github.com/articles/creating-and-highlighting-code-blocks/    
-->
<!--
    <script>
        async("http://cdn.bootcss.com/highlight.js/8.6/highlight.min.js", function(){
            hljs.initHighlightingOnLoad();
        })
    </script>
    <link href="http://cdn.bootcss.com/highlight.js/8.6/styles/github.min.css" rel="stylesheet">
-->


<!-- jquery.tagcloud.js -->
<script>
    // only load tagcloud.js in tag.html
    if($('#tag_cloud').length !== 0){
        async("https://nifannn.github.io/js/jquery.tagcloud.js",function(){
            $.fn.tagcloud.defaults = {
                //size: {start: 1, end: 1, unit: 'em'},
                color: {start: '#bbbbee', end: '#0085a1'},
            };
            $('#tag_cloud a').tagcloud();
        })
    }
</script>

<!--fastClick.js -->
<script>
    async("https://cdn.bootcss.com/fastclick/1.0.6/fastclick.min.js", function(){
        var $nav = document.querySelector("nav");
        if($nav) FastClick.attach($nav);
    })
</script>


<!-- Google Analytics -->




<!-- Baidu Tongji -->






	<a id="rocket" href="#top" class=""></a>
	<script type="text/javascript" src="/js/totop.js?v=1.0.0" async=""></script>
    <script type="text/javascript" src="/js/toc.js?v=1.0.0" async=""></script>
<!-- Image to hack wechat -->
<img src="https://nifannn.github.io/img/icon_wechat.png" width="0" height="0" />
<!-- Migrate from head to bottom, no longer block render and still work -->

</body>

</html>
